!function(){var t,e=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};t=["extended","included"],this.Gmaps4Rails={},this.Gmaps4Rails.Common=function(){function o(){}return o.extend=function(o){var n,r,i;for(n in o)r=o[n],e.call(t,n)<0&&(this[n]=r);return null!=(i=o.extended)&&i.apply(this),this},o.include=function(o){var n,r,i;for(n in o)r=o[n],e.call(t,n)<0&&(this.prototype[n]=r);return null!=(i=o.included)&&i.apply(this),this},o.prototype.exists=function(t){return""!==t&&"undefined"!=typeof t},o.prototype.mergeObjects=function(t,e){return this.constructor.mergeObjects(t,e)},o.mergeObjects=function(t,e){var o,n,r;o={};for(n in t)r=t[n],o[n]=r;for(n in e)r=e[n],null==o[n]&&(o[n]=r);return o},o.mergeWith=function(t){var e,o,n;n=[];for(e in t)o=t[e],null==this[e]?n.push(this[e]=o):n.push(void 0);return n},o.prototype.random=function(){return 2*Math.random()-1},o}()}.call(this),function(){this.Gmaps4Rails.Configuration={setConf:function(){return null!=this.CONF?this.mergeObjects(this.CONF,this.DEFAULT_CONF):this.DEFAULT_CONF}}}.call(this),function(){this.Gmaps={triggerOldOnload:function(){return"function"==typeof window.Gmaps.oldOnload?window.Gmaps.oldOnload():void 0},loadMaps:function(){var t,e,o,n;o=window.Gmaps,n=[];for(t in o)e=o[t],/^load_/.test(t)?n.push(window.Gmaps[t]()):n.push(void 0);return n}}}.call(this),function(){this.Gmaps4Rails.Circle={},this.Gmaps4Rails.Circle.Class={DEFAULT_CONF:{fillColor:"#00AAFF",fillOpacity:.35,strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,clickable:!1,zIndex:null}}}.call(this),function(){this.Gmaps4Rails.Kml={},this.Gmaps4Rails.Kml.Instance={DEFAULT_CONF:{clickable:!0,preserveViewport:!1,suppressInfoWindows:!1}}}.call(this),function(){this.Gmaps4Rails.Map={DEFAULT_CONF:{id:"map",draggable:!0,detect_location:!1,center_on_user:!1,center_latitude:0,center_longitude:0,zoom:7,maxZoom:null,minZoom:null,auto_adjust:!0,auto_zoom:!0,bounds:[],raw:{}},adjustToBounds:function(){return this.boundsObject=this.createLatLngBounds(),this.extendBoundsWithMarkers(),this.extendBoundsWithPolylines(),this.extendBoundsWithPolygons(),this.extendBoundsWithCircles(),this.extendBoundsWithLatLng(),this.adaptToBounds()},extendBoundsWithMarkers:function(){var t,e,o,n,r;for(n=this.controller.markers,r=[],e=0,o=n.length;o>e;e++)t=n[e],t.isVisible()?r.push(this.extendBoundsWithMarker(t)):r.push(void 0);return r},extendBoundsWithPolylines:function(){var t,e,o,n,r;for(n=this.controller.polylines,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(this.extendBoundsWithPolyline(t));return r},extendBoundsWithPolygons:function(){var t,e,o,n,r;for(n=this.controller.polygons,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(this.extendBoundsWithPolygon(t));return r},extendBoundsWithCircles:function(){var t,e,o,n,r;for(n=this.controller.circles,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(this.extendBoundsWithCircle(t));return r},extendBoundsWithLatLng:function(){var t,e,o,n,r;for(n=this.options.bounds,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(this.extendBound(t));return r},autoAdjustRequested:function(){return this.options.auto_adjust||this.options.bounds.length>0}}}.call(this),function(){this.Gmaps4Rails.Marker={},this.Gmaps4Rails.Marker.Class={DEFAULT_CONF:{title:null,picture:null,width:22,length:32,draggable:!1,do_clustering:!1,randomize:!1,max_random_distance:100,list_container:null,offset:0,raw:{}}},this.Gmaps4Rails.Marker.Instance={getMap:function(){return this.controller.getMapObject()}}}.call(this),function(){this.Gmaps4Rails.Polygon={},this.Gmaps4Rails.Polygon.Class={DEFAULT_CONF:{strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,fillColor:"#000000",fillOpacity:.35,clickable:!1}}}.call(this),function(){this.Gmaps4Rails.Polyline={},this.Gmaps4Rails.Polyline.Class={DEFAULT_CONF:{strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2,clickable:!1,zIndex:null,icons:null}}}.call(this),function(){this.Gmaps4Rails.CircleController={addCircles:function(t){var e,o,n,r;for(r=[],o=0,n=t.length;n>o;o++)e=t[o],r.push(this.circles.push(this.createCircle(e)));return r},replaceCircles:function(t){return this.clearCircles(),this.addCircles(t),this.adjustMapToBounds()},clearCircles:function(){var t,e,o,n;for(n=this.circles,e=0,o=n.length;o>e;e++)t=n[e],t.clear();return this.circles=[]},showCircles:function(){var t,e,o,n,r;for(n=this.circles,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.show());return r},hideCircles:function(){var t,e,o,n,r;for(n=this.circles,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.hide());return r}}}.call(this),function(){this.Gmaps4Rails.KmlController={addKml:function(t){var e,o,n,r;for(r=[],o=0,n=t.length;n>o;o++)e=t[o],r.push(this.kmls.push(this.createKml(e)));return r}}}.call(this),function(){this.Gmaps4Rails.MarkerController={addMarkers:function(t){var e,o,n,r,i,s,l,a;for(null!=this.markerClusterer&&this.clearClusterer(),e=l=0,a=t.length;a>l;e=++l)i=t[e],o=i.lat,r=i.lng,this.markers_conf.randomize&&(n=this.randomize(o,r),o=n[0],r=n[1]),s=this.createMarker({marker_picture:i.picture?i.picture:this.markers_conf.picture,marker_width:i.width?i.width:this.markers_conf.width,marker_height:i.height?i.height:this.markers_conf.length,marker_title:i.title?i.title:null,marker_anchor:i.marker_anchor?i.marker_anchor:null,shadow_anchor:i.shadow_anchor?i.shadow_anchor:null,shadow_picture:i.shadow_picture?i.shadow_picture:null,shadow_width:i.shadow_width?i.shadow_width:null,shadow_height:i.shadow_height?i.shadow_height:null,marker_draggable:i.draggable?i.draggable:this.markers_conf.draggable,rich_marker:i.rich_marker?i.rich_marker:null,zindex:i.zindex?i.zindex:null,lat:o,lng:r,index:e}),Gmaps4Rails.Common.mergeWith.call(s,i),s.createInfoWindow(),this.markers.push(s);return this.clusterize()},replaceMarkers:function(t){return this.clearMarkers(),this.markers=[],this.boundsObject=this.createLatLngBounds(),this.addMarkers(t)},clearMarkers:function(){var t,e,o,n;for(null!=this.markerClusterer&&this.clearClusterer(),n=this.markers,e=0,o=n.length;o>e;e++)t=n[e],t.clear();return this.markers=[]},showMarkers:function(){var t,e,o,n,r;for(n=this.markers,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.show());return r},hideMarkers:function(){var t,e,o,n,r;for(n=this.markers,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.hide());return r},randomize:function(t,e){var o,n,r,i;return r=this.markers_conf.max_random_distance*this.random(),i=this.markers_conf.max_random_distance*this.random(),o=parseFloat(t)+180/Math.PI*(i/6378137),n=parseFloat(e)+90/Math.PI*(r/6378137)/Math.cos(t),[o,n]}}}.call(this),function(){this.Gmaps4Rails.PolygonController={addPolygons:function(t){var e,o,n,r;for(r=[],o=0,n=t.length;n>o;o++)e=t[o],r.push(this.polygons.push(this.createPolygon(e)));return r},replacePolygons:function(t){return this.clearPolygons(),this.addPolygons(t),this.adjustMapToBounds()},clearPolygons:function(){var t,e,o,n;for(n=this.polygons,e=0,o=n.length;o>e;e++)t=n[e],t.clear();return this.polygons=[]},showPolygons:function(){var t,e,o,n,r;for(n=this.polygons,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.show());return r},hidePolygons:function(){var t,e,o,n,r;for(n=this.polygons,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.hide());return r}}}.call(this),function(){this.Gmaps4Rails.PolylineController={replacePolylines:function(t){return this.clearPolylines(),this.addPolylines(t),this.adjustMapToBounds()},clearPolylines:function(){var t,e,o,n;for(n=this.polylines,e=0,o=n.length;o>e;e++)t=n[e],t.clear();return this.polylines=[]},addPolylines:function(t){var e,o,n,r;for(r=[],o=0,n=t.length;n>o;o++)e=t[o],r.push(this.polylines.push(this.createPolyline(e)));return r},showPolylines:function(){var t,e,o,n,r;for(n=this.polylines,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.show());return r},hidePolylines:function(){var t,e,o,n,r;for(n=this.polylines,r=[],e=0,o=n.length;o>e;e++)t=n[e],r.push(t.hide());return r}}}.call(this),function(){Gmaps4Rails.Interfaces||(Gmaps4Rails.Interfaces={}),Gmaps4Rails.Interfaces.Basic={clear:function(){throw"clear should be implemented"},show:function(){throw"show should be implemented"},hide:function(){throw"hide should be implemented"},isVisible:function(){throw"hide should be implemented"}}}.call(this),function(){Gmaps4Rails.Interfaces||(Gmaps4Rails.Interfaces={}),Gmaps4Rails.Interfaces.Controller={getModule:function(){throw"getModule should be implemented in controller"},createClusterer:function(){throw"createClusterer should be implemented in controller"},clearClusterer:function(){throw"clearClusterer should be implemented in controller"}}}.call(this),function(){Gmaps4Rails.Interfaces||(Gmaps4Rails.Interfaces={}),Gmaps4Rails.Interfaces.Map={extendBoundsWithMarker:function(){throw"extendBoundsWithMarker should be implemented in controller"},extendBoundsWithPolyline:function(){throw"extendBoundsWithPolyline should be implemented in controller"},extendBoundsWithPolygon:function(){throw"extendBoundsWithPolygon should be implemented in controller"},extendBoundsWithCircle:function(){throw"extendBoundsWithCircle should be implemented in controller"},extendBound:function(){throw"extendBound should be implemented in controller"},adaptToBounds:function(){throw"adaptToBounds should be implemented in controller"},fitBounds:function(){throw"fitBounds should be implemented in controller"},centerMapOnUser:function(){throw"centerMapOnUser should be implemented in controller"}}}.call(this),function(){Gmaps4Rails.Interfaces||(Gmaps4Rails.Interfaces={}),Gmaps4Rails.Interfaces.Marker={createInfoWindow:function(){throw"createInfoWindow should be implemented in marker"},clear:function(){throw"clear should be implemented in marker"},show:function(){throw"show should be implemented in marker"},hide:function(){throw"hide should be implemented in marker"}}}.call(this),function(){var t={}.hasOwnProperty,e=function(e,o){function n(){this.constructor=e}for(var r in o)t.call(o,r)&&(e[r]=o[r]);return n.prototype=o.prototype,e.prototype=new n,e.__super__=o.prototype,e};this.Gmaps4Rails.BaseController=function(t){function o(){this.rootModule=this.getModule(),null!=this.rootModule.Marker&&(this.markers_conf=this.rootModule.Marker.setConf()),null!=this.rootModule.Polyline&&(this.polylines_conf=this.rootModule.Polyline.setConf()),null!=this.rootModule.Polygon&&(this.polygons_conf=this.rootModule.Polygon.setConf()),null!=this.rootModule.Circle&&(this.circles_conf=this.rootModule.Circle.setConf())}return e(o,t),o.include(Gmaps4Rails.MarkerController),o.include(Gmaps4Rails.PolylineController),o.include(Gmaps4Rails.PolygonController),o.include(Gmaps4Rails.CircleController),o.include(Gmaps4Rails.KmlController),o.include(Gmaps4Rails.Interfaces.Controller),o.prototype.visibleInfoWindow=null,o.prototype.userLocation=null,o.prototype.afterMapInitialization=function(){return!1},o.prototype.geolocationSuccess=function(){return!1},o.prototype.geolocationFailure=function(){return!1},o.prototype.callback=function(){return!1},o.prototype.customClusterer=function(){return!1},o.prototype.infobox=function(){return!1},o.prototype.jsTemplate=!1,o.prototype.map_options={},o.prototype.markers=[],o.prototype.boundsObject=null,o.prototype.polygons=[],o.prototype.polylines=[],o.prototype.circles=[],o.prototype.markerClusterer=null,o.prototype.markerImages=[],o.prototype.kmls=[],o.prototype.rootModule=null,o.prototype.createMap=function(){return new this.rootModule.Map(this.map_options,this)},o.prototype.createMarker=function(t){return new this.rootModule.Marker(t,this)},o.prototype.createPolyline=function(t){return new this.rootModule.Polyline(t,this)},o.prototype.createPolygon=function(t){return new this.rootModule.Polygon(t,this)},o.prototype.createCircle=function(t){return new this.rootModule.Circle(t,this)},o.prototype.createKml=function(t){return new this.rootModule.Kml(t,this)},o.prototype.initialize=function(){var t,e;return e=this.map_options.detect_location||this.map_options.center_on_user,t=this.map_options.center_on_user,this.map=this.createMap(),this.afterMapInitialization(),delete this.map_options,e?this.findUserLocation(this,t):void 0},o.prototype.getMapObject=function(){return this.map.serviceObject},o.prototype.adjustMapToBounds=function(){return this.map.autoAdjustRequested()?this.map.adjustToBounds():void 0},o.prototype.clusterize=function(){var t,e,o,n,r;if(this.markers_conf.do_clustering){for(null!=this.markerClusterer&&this.clearClusterer(),e=[],r=this.markers,o=0,n=r.length;n>o;o++)t=r[o],e.push(t.serviceObject);return this.markerClusterer=this.createClusterer(e)}},o.prototype.findUserLocation=function(t,e){var o,n;return navigator.geolocation?(n=function(o){return t.userLocation=t.createLatLng(o.coords.latitude,o.coords.longitude),t.geolocationSuccess(),e?t.map.centerMapOnUser(t.userLocation):void 0},o=function(){return t.geolocationFailure(!0)},navigator.geolocation.getCurrentPosition(n,o)):t.geolocationFailure(!1)},o}(Gmaps4Rails.Common)}.call(this),function(){}.call(this);